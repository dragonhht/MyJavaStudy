<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace命名空间，对Sql进行分类化管理 ,namespace等于mapper接口的地址-->
<mapper namespace="com.dragon.mapper.SearchMapper">

    <!--通过图书名查询图书-->
    <select id="searchBookByName" parameterType="PageParam" resultType="BookInType">
        select b.*,t.*
        from Book b,BookType t,BookInType i
        where b.bookName like #{bookMessage} and b.bookId = i.bookId and i.typeId = t.typeId
        limit #{pageCount} , #{pageSize}
    </select>

    <!--通过出版社查询图书-->
    <select id="searchBookByPublish" parameterType="PageParam" resultType="BookInType">
        select b.*,t.*
        from Book b,BookType t,BookInType i
        where b.publish like #{bookMessage} and b.bookId = i.bookId and i.typeId = t.typeId
        limit #{pageCount} , #{pageSize}
    </select>

    <!--通过作者查询图书-->
    <select id="searchBookByAuthor" parameterType="PageParam" resultType="BookInType">
        select b.*,t.*
        from Book b,BookType t,BookInType i
        where b.author like #{bookMessage} and b.bookId = i.bookId and i.typeId = t.typeId
        limit #{pageCount} , #{pageSize}
    </select>

    <!--根据图书编号查询图书-->
    <select id="searchBookById" parameterType="long" resultType="BookInType">
        select * from Book where bookId = #{value}
    </select>

    <!--根据图书类型查询图书-->
    <select id="searchBookByType" parameterType="long" resultType="BookInType">
        select b.*,t.*
        from Book b,BookType t,BookInType i
        where i.typeId = #{value} and b.bookId = i.bookId and i.typeId = t.typeId
    </select>

    <!--获取通过作者查找到的图书数量-->
    <select id="getResultSumByAuthor" parameterType="string" resultType="int">
        select count(*)
        from Book b,BookType t,BookInType i
        where b.author like #{value} and b.bookId = i.bookId and i.typeId = t.typeId
    </select>

    <!--获取通过图书名查找到的数量-->
    <select id="getResultSumByName" parameterType="string" resultType="int">
        select COUNT(*)
        from Book b,BookType t,BookInType i
        where b.bookName like #{value} and b.bookId = i.bookId and i.typeId = t.typeId
    </select>

    <!--获取通过出版社查找到的数量-->
    <select id="getResultSumByPublish" parameterType="String" resultType="int">
        select COUNT(*)
        from Book b,BookType t,BookInType i
        where b.publish like #{value} and b.bookId = i.bookId and i.typeId = t.typeId
    </select>

</mapper>